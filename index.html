<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„è®¡ç®—ç¨‹åºå¦‚ä¸‹</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f6f8fa; }
        h1 { color: #24292e; border-bottom: 1px solid #e1e4e8; padding-bottom: 10px; }
        #file-list { list-style: none; padding: 0; background: white; border-radius: 6px; border: 1px solid #e1e4e8; }
        #file-list li { border-bottom: 1px solid #e1e4e8; }
        #file-list li:last-child { border-bottom: none; }
        #file-list a { display: block; padding: 15px 20px; text-decoration: none; color: #0366d6; transition: background 0.2s; }
        #file-list a:hover { background-color: #f1f8ff; text-decoration: underline; }
        .loading { color: #666; font-style: italic; }
        .error { color: #d73a49; background: #ffdce0; padding: 10px; border-radius: 4px; }
    </style>
</head>
<body>

    <h1>ğŸ“„ æ–‡ä»¶ç›®å½•</h1>
    <ul id="file-list">
        <li class="loading">æ­£åœ¨åŠ è½½æ–‡ä»¶åˆ—è¡¨...</li>
    </ul>

    <script>
        // è‡ªåŠ¨è·å–å½“å‰çš„ç”¨æˆ·åå’Œä»“åº“å
        // å‡è®¾ URL æ˜¯ https://username.github.io/repo-name/
        const pathParts = window.location.pathname.split('/').filter(part => part.length > 0);
        
        // GitHub Pages çš„è·¯å¾„é€šå¸¸æ˜¯ /repo-name/ï¼Œå¦‚æœæ˜¯æ ¹åŸŸååˆ™æ˜¯ç©º
        // æ³¨æ„ï¼šå¦‚æœä½ ç»‘å®šäº†è‡ªå®šä¹‰åŸŸåï¼Œè¿™æ®µé€»è¾‘å¯èƒ½éœ€è¦æ‰‹åŠ¨æŒ‡å®š user å’Œ repo
        const repoName = pathParts[0]; 
        const userName = window.location.hostname.split('.')[0];

        // å¦‚æœæ— æ³•è‡ªåŠ¨è·å–ï¼ˆæ¯”å¦‚åœ¨æœ¬åœ°æµ‹è¯•ï¼‰ï¼Œè¯·æ‰‹åŠ¨ä¿®æ”¹ä¸‹é¢ä¸¤è¡Œï¼š
        // const userName = "ä½ çš„GitHubç”¨æˆ·å";
        // const repoName = "ä½ çš„ä»“åº“å";

        async function fetchFileList() {
            const listElement = document.getElementById('file-list');
            
            // æ„å»º GitHub API åœ°å€
            const apiUrl = `https://api.github.com/repos/${userName}/${repoName}/contents/`;

            try {
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error(`API è¯·æ±‚å¤±è´¥: ${response.status}`);
                
                const data = await response.json();
                
                // æ¸…ç©ºåŠ è½½æç¤º
                listElement.innerHTML = '';

                // ç­›é€‰å‡º html æ–‡ä»¶ï¼Œå¹¶æ’é™¤ index.html æœ¬èº«
                const htmlFiles = data.filter(file => 
                    file.name.endsWith('.html') && 
                    file.name !== 'index.html'
                );

                if (htmlFiles.length === 0) {
                    listElement.innerHTML = '<li style="padding:15px">æš‚æ— å…¶ä»– HTML æ–‡ä»¶</li>';
                    return;
                }

                // ç”Ÿæˆåˆ—è¡¨
                htmlFiles.forEach(file => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = file.name; // ç›¸å¯¹è·¯å¾„è·³è½¬
                    a.textContent = file.name;
                    li.appendChild(a);
                    listElement.appendChild(li);
                });

            } catch (error) {
                console.error(error);
                listElement.innerHTML = `<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä»“åº“åç§°æ˜¯å¦æ­£ç¡®ï¼Œæˆ– API è°ƒç”¨æ¬¡æ•°æ˜¯å¦è¶…é™ã€‚<br>é”™è¯¯ä¿¡æ¯: ${error.message}</div>`;
            }
        }

        // æ‰§è¡Œå‡½æ•°
        if (window.location.hostname === 'localhost' || window.location.protocol === 'file:') {
             document.getElementById('file-list').innerHTML = '<div class="error">è¯·åœ¨ GitHub Pages ç¯å¢ƒä¸‹è¿è¡Œæ­¤é¡µé¢ï¼Œæœ¬åœ°è¿è¡Œæ— æ³•è°ƒç”¨ APIã€‚</div>';
        } else {
            fetchFileList();
        }
    </script>
</body>

</html>
